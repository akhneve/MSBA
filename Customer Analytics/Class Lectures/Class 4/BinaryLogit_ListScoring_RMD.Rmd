---
title: "BinaryLogit_ListScoring_RMD"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## First Steps 

NOTE: Your data needs to be in the folder where your code is located!

The first Chunk of Code will always do 3 Things for us

1) Clear ALL Variables (to make sure nothing is "left over") and clear the      screen. 
2) Read in the data we want to use. In our case the file is called              "Data_Binary Logit_List Scoring_R.csv"
3) Explore the data (what variables are in it and what are some basic           statistics for these variables)

```{r}

# Clear All Variables & Clear Screen
rm(list=ls())
cat("\014")

# Read in the Data
data.list = read.csv("Data_Binary Logit_List Scoring_R.csv")

# Explore the datam
str(data.list)
summary(data.list)
```


## BINARY LOGIT MODEL 

1) Define y (Dependent Variable). For this example, y_Response (a consumer either buys or not) is used

2) Define X (Independent Variables). For this example, x1_Gender, x2_Hotline1 and x3_Hotline2 are used

3) Run the Models. For example, a model where response (y_response) is a function of gender (x1_gender), Hotline1 (x2_Hotline1), and Hotline2 (x3_Hotline2)

```{r}
# Run the Regression (includes an INTERCEPT)
lm.model <- lm(y_Response ~ x1_Gender+ x2_Hotline1+ x3_Hotline2, data = data.list)

# Display Results
summary(lm.model)

# Run the Binary Logit Model (includes an INTERCEPT)
glm.model <- glm(y_Response ~ x1_Gender+ x2_Hotline1+ x3_Hotline2,family=binomial(link='logit'),data=data.list)

# Display Results
summary(glm.model)
```


## SCORING

Using the estimates from the LINEAR REGRESSION Model (lm.model) and the BINARY LOGIT Model (glm.model) predict the buy/no buy decision for each of the 200 IDs using the model estimates from the two models

```{r}

# Predicting Buy/No Buy for the 200 IDs based on the Model Estimates
(prediction <- data.frame(ID = data.list$ID, 
               LinearRegressionPredict =  round(predict(lm.model),digits = 0), 
               BinaryLogitProb         = predict(glm.model,type = c("response")),                                      BinaryLogitPredict      = round(predict(glm.model,type = c("response")), digits = 0)))

# Prediciton of Number of Buyers
sum(prediction["LinearRegressionPredict"])
sum(prediction["BinaryLogitPredict"])

# Exporting the Predictions to Excel
# You can open a csv file in xl
write.csv(prediction, file = "Prediction.csv")

```
